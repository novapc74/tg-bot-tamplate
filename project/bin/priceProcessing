#!/usr/bin/env php
<?php

use App\Handlers\PayloadDto;

if (!file_exists($bootstrap = __DIR__ . '/../config/bootstrap.php')) {
    exit('Bootstrap file not found.');
}

require_once $bootstrap;

global $container;

function toArray(): array
{
    $content = '{
    "update_id": 458558897,
    "message": {
        "message_id": 1186,
        "from": {
            "id": 645759570,
            "is_bot": false,
            "first_name": "Вячеслав",
            "last_name": "Макаров",
            "username": "novapc",
            "language_code": "en"
        },
        "chat": {
            "id": 645759570,
            "first_name": "Вячеслав",
            "last_name": "Макаров",
            "username": "novapc",
            "type": "private"
        },
        "date": 1764231962,
        "text": "\/help",
        "entities": [
            {
                "offset": 0,
                "length": 5,
                "type": "bot_command"
            }
        ]
    }
}';

    return json_decode($content, true);
}

$dto = PayloadDto::init(toArray());

echo PHP_EOL . $dto->getText() . PHP_EOL . $dto->getChat()->getId() . PHP_EOL;

